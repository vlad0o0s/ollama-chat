# Ollama Chat

–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ LLM –º–æ–¥–µ–ª—è–º–∏ —á–µ—Ä–µ–∑ Ollama. –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —á–∞—Ç —Å —Å–∏—Å—Ç–µ–º–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —á–∞—Ç–∞–º–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üí¨ **–ß–∞—Ç —Å LLM –º–æ–¥–µ–ª—è–º–∏** - –û–±—â–µ–Ω–∏–µ —Å –ª—é–±—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ Ollama –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üîç **–ü–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Tavily API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- üé® **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** - –°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ ComfyUI –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π
- üñºÔ∏è **Image-to-Image —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è** - –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é Flux.1-dev
- üëÅÔ∏è **–í–∏–∑—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ LLaVA
- üîÑ **Batch –≥–µ–Ω–µ—Ä–∞—Ü–∏—è** - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ä–∞–∑–Ω—ã–º–∏ seed
- üéØ **Natural Language –ø—Ä–æ–º–ø—Ç—ã** - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è Flux.1-dev
- üîê **–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –≤—Ö–æ–¥, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º
- üìù **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞–º–∏** - –°–æ–∑–¥–∞–Ω–∏–µ, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–æ–≤
- ‚úèÔ∏è **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π** - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
- üë• **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ä–æ–ª—è–º–∏
- üé® **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI** - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Markdown
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt)
- üì± **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω** - –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ –∏ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- üñ•Ô∏è **GPU Resource Management** - –£–º–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ GPU —Ä–µ—Å—É—Ä—Å–∞–º–∏ –º–µ–∂–¥—É Ollama –∏ ComfyUI
- üîÑ **Process Management** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É Ollama –∏ ComfyUI —Å –∑–∞—â–∏—Ç–æ–π –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- Node.js 16+
- Ollama (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∏ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –ª–æ–∫–∞–ª—å–Ω–æ)
- ComfyUI (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- MySQL (–¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö) –∏–ª–∏ SQLite
- NVIDIA GPU (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- Process Manager (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤)

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone <repository-url>
cd GPTChat
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:
```bash
start.bat
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç –±—ç–∫–µ–Ω–¥ –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö.

### –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

#### –ë—ç–∫–µ–Ω–¥

```bash
cd backend

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è (Windows PowerShell)
.\venv\Scripts\Activate.ps1

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è (Windows CMD)
venv\Scripts\activate.bat

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è (Linux/Mac)
source venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ JWT_SECRET

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
python run.py
```

–ë—ç–∫–µ–Ω–¥ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:5000`

#### –§—Ä–æ–Ω—Ç–µ–Ω–¥

```bash
cd frontend

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å URL API

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
npm start
```

–§—Ä–æ–Ω—Ç–µ–Ω–¥ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:3000`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
GPTChat/
‚îú‚îÄ‚îÄ backend/                 # Python FastAPI –±—ç–∫–µ–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py         # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py     # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/         # SQLAlchemy –º–æ–¥–µ–ª–∏ (User, Chat, Message)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/         # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py     # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ chats.py    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞–º–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.py    # –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ search_chat.py  # –ß–∞—Ç —Å –ø–æ–∏—Å–∫–æ–º
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ image_generation.py  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ process.py  # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (Ollama/ComfyUI)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas/        # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/       # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ search_service.py      # –°–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞ (Tavily)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ comfyui_service.py     # –°–µ—Ä–≤–∏—Å ComfyUI
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prompt_service.py      # –°–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–≤–æ–¥–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ –∏ –∞–Ω–∞–ª–∏–∑–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ resource_manager.py    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ GPU —Ä–µ—Å—É—Ä—Å–∞–º–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ process_manager_service.py  # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ —á–µ—Ä–µ–∑ Process Manager API
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vram_monitor.py        # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ VRAM
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ service_types.py      # –¢–∏–ø—ã —Å–µ—Ä–≤–∏—Å–æ–≤ (Ollama/ComfyUI)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/           # JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/          # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ image_storage.py  # –•—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ add_edit_delete_fields_to_messages.py  # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ static/             # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ images/         # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt    # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ run.py              # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ frontend/               # React —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/     # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.js          # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.js  # –ö–æ–Ω—Ç–µ–∫—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ package.json        # Node.js –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ process_manager/        # Process Manager –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚îú‚îÄ‚îÄ start.bat               # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ AUDIT_IMG_TO_IMG.md     # –ê—É–¥–∏—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îú‚îÄ‚îÄ TROUBLESHOOTING.md      # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º
‚îî‚îÄ‚îÄ README.md
```

## üé® –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ ComfyUI:

### 1. Text-to-Image (–¢–µ–∫—Å—Ç –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)

–°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.

#### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ] --> B[GPT-OSS –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –≤ Natural Language –ø—Ä–æ–º–ø—Ç]
    B --> C[ComfyUI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ]
    C --> D[–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è]
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
2. –õ–æ–∫–∞–ª—å–Ω–∞—è LLM (GPT-OSS —á–µ—Ä–µ–∑ Ollama) –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π Natural Language –ø—Ä–æ–º–ø—Ç –¥–ª—è Flux.1-dev
3. ComfyUI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É—è –º–æ–¥–µ–ª—å Flux.1-dev
4. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —á–∞—Ç–µ

### 2. Image-to-Image (–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)

–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è.

#### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ] --> B[LLaVA –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ]
    B --> C[GPT-OSS –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Natural Language –ø—Ä–æ–º–ø—Ç]
    C --> D[GPT-OSS –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ KSampler]
    D --> E[ComfyUI —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ]
    E --> F[–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è]
    
    style B fill:#e1f5ff
    style C fill:#e1f5ff
    style D fill:#e1f5ff
```

**–î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:**

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
   - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –∏ —Å–∂–∏–º–∞–µ—Ç—Å—è –¥–æ 1024px (–µ—Å–ª–∏ –±–æ–ª—å—à–µ)
   - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

2. **–í–∏–∑—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (LLaVA)**
   - LLaVA (—á–µ—Ä–µ–∑ Ollama) –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ:
     - –¶–≤–µ—Ç–∞ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤
     - –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ —Ç–µ–∫—Å—Ç—É—Ä—ã
     - –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ
     - –û—Å–≤–µ—â–µ–Ω–∏–µ –∏ —Å—Ç–∏–ª—å
   - –û–ø–∏—Å–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–∞

3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–∞ (GPT-OSS)**
   - GPT-OSS –ø–æ–ª—É—á–∞–µ—Ç:
     - –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç LLaVA
     - –ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Natural Language –ø—Ä–æ–º–ø—Ç –¥–ª—è Flux.1-dev:
     - –ü–æ–ª–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ tag-based –ø—Ä–æ–º–ø—Ç–æ–≤
     - –§–æ–∫—É—Å –Ω–∞ –∂–µ–ª–∞–µ–º–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
     - –ë–µ–∑ "junk words" (photorealistic, 8k, masterpiece)
     - Negative prompt –≤—Å–µ–≥–¥–∞ –ø—É—Å—Ç–æ–π (Flux.1-dev –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ)

4. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ KSampler (GPT-OSS)**
   - GPT-OSS –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
     - **Denoise**: 0.55-0.65 –¥–ª—è —Ü–≤–µ—Ç–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è Flux.1-dev)
     - **Steps**: 25-30
     - **CFG**: 1.0 (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ –¥–ª—è Flux)
     - **Sampler**: euler (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è img-to-img)

5. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤ ComfyUI**
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ ComfyUI
   - –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ KSampler
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Natural Language –ø—Ä–æ–º–ø—Ç
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

6. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**
   - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
   - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î:
     - –ü—Ä–æ–º–ø—Ç—ã (positive –∏ negative)
     - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ KSampler
     - Seed –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
     - –û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç LLaVA
     - –†–∞–∑–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Flux.1-dev

- **Natural Language –ø—Ä–æ–º–ø—Ç—ã**: Flux.1-dev –ø–æ–Ω–∏–º–∞–µ—Ç –ø–æ–ª–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –∞ –Ω–µ —Å–ø–∏—Å–∫–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
- **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π denoise**: 0.55-0.65 –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π (–≤—ã—à–µ —Ä–∞–∑—Ä—É—à–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É)
- **–ë–µ–∑ negative prompt**: Flux.1-dev –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç negative conditioning
- **–ö–∞—á–µ—Å—Ç–≤–æ —á–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–º–ø—Ç**: –í—Å–µ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ positive –ø—Ä–æ–º–ø—Ç

### Batch Processing

–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:

- –ü–∞—Ä–∞–º–µ—Ç—Ä `batch_count` (1-4 –≤–∞—Ä–∏–∞–Ω—Ç–∞)
- –ö–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π seed
- –í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## üñ•Ô∏è GPU Resource Management

–°–∏—Å—Ç–µ–º–∞ —É–º–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è GPU —Ä–µ—Å—É—Ä—Å–∞–º–∏ –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–µ–∂–¥—É Ollama –∏ ComfyUI.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞–º–∏:

```mermaid
graph TD
    A[–ó–∞–ø—Ä–æ—Å –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU] --> B{Resource Manager}
    B --> C{–ü—Ä–æ—Ü–µ—Å—Å –∞–∫—Ç–∏–≤–µ–Ω?}
    C -->|–ù–µ—Ç| D[–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞]
    C -->|–î–∞| E[–ü—Ä–æ–≤–µ—Ä–∫–∞ VRAM]
    D --> E
    E --> F{VRAM —Å–≤–æ–±–æ–¥–Ω–∞?}
    F -->|–î–∞| G[–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ GPU]
    F -->|–ù–µ—Ç| H[–û–∂–∏–¥–∞–Ω–∏–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è]
    H --> E
    G --> I[–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏]
    I --> J[–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ GPU]
    J --> K{–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Ollama?}
    K -->|–î–∞| L[–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ Ollama]
    K -->|–ù–µ—Ç| M[–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ]
    L --> M
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **Resource Manager** (`resource_manager.py`)
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—å—é –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ GPU
   - –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á (ComfyUI > Ollama)
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ Ollama –ø–æ—Å–ª–µ ComfyUI

2. **Process Manager Service** (`process_manager_service.py`)
   - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (Ollama ‚Üî ComfyUI)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
   - –¢–∞–π–º–∞—É—Ç—ã –∏ retry –ª–æ–≥–∏–∫–∞

3. **VRAM Monitor** (`vram_monitor.py`)
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è VRAM
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ GPU
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Ollama

–î–ª—è img-to-img –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ Ollama –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è:

```mermaid
sequenceDiagram
    participant User
    participant API
    participant ResourceManager
    participant Ollama
    participant LLaVA
    participant GPT-OSS
    participant ComfyUI

    User->>API: –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ + –∑–∞–ø—Ä–æ—Å
    API->>ResourceManager: –ó–∞–ø—Ä–æ—Å GPU –¥–ª—è Ollama
    ResourceManager->>Ollama: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
    Note over ResourceManager,Ollama: GPU –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
    
    API->>LLaVA: –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    LLaVA-->>API: –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    
    API->>GPT-OSS: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–∞
    GPT-OSS-->>API: Natural Language –ø—Ä–æ–º–ø—Ç
    
    API->>GPT-OSS: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ KSampler
    GPT-OSS-->>API: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (denoise, steps, etc.)
    
    Note over ResourceManager,Ollama: GPU –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω
    
    API->>ResourceManager: –ó–∞–ø—Ä–æ—Å GPU –¥–ª—è ComfyUI
    ResourceManager->>ComfyUI: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
    API->>ComfyUI: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    ComfyUI-->>API: –†–µ–∑—É–ª—å—Ç–∞—Ç
    
    ResourceManager->>Ollama: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
    API-->>User: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ë—ç–∫–µ–Ω–¥ (.env)

```env
# JWT –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
JWT_SECRET=your-secret-key-here

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (MySQL)
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your-password
DB_NAME=ollama_chat
DB_USE_MYSQL=true

# Ollama
OLLAMA_URL=http://localhost:11434
OLLAMA_DEFAULT_MODEL=gpt-oss:20b
OLLAMA_VISION_MODEL=llava:13b
OLLAMA_VISION_TIMEOUT=30

# Tavily Search API (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
TAVILY_API_KEY=your-tavily-api-key

# ComfyUI (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
COMFYUI_URL=http://your-comfyui-server:8188
COMFYUI_MODEL=flux1-dev-fp8
COMFYUI_TIMEOUT=300
COMFYUI_WORKFLOW_PATH=C:/ComfyUI_windows_portable/ComfyUI/Flux.json
COMFYUI_WORKFLOW_IMG2IMG_PATH=C:/ComfyUI_windows_portable/ComfyUI/Flux-img-to-img.json

# –•—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
IMAGE_STORAGE_PATH=static/images
IMAGE_DEFAULT_WIDTH=1024
IMAGE_DEFAULT_HEIGHT=1024
IMAGE_MAX_WIDTH_UPLOAD=4096
IMAGE_MAX_HEIGHT_UPLOAD=4096
IMAGE_MAX_SIZE_FOR_GENERATION=1024

# GPU Resource Management
GPU_MONITOR_ENABLED=true
GPU_MONITOR_INTERVAL=2
GPU_VRAM_THRESHOLD=90
GPU_MIN_FREE_VRAM_MB=1024
GPU_WAIT_TIMEOUT=300
GPU_PRIORITY_COMFYUI=10
GPU_PRIORITY_OLLAMA=5
GPU_ALWAYS_RESTORE_OLLAMA_AFTER_COMFYUI=true

# Process Management API
PROCESS_MANAGER_API_URL=http://localhost:8888
PROCESS_SWITCH_TIMEOUT=30
PROCESS_STARTUP_WAIT=10
PROCESS_RESTORE_ON_RELEASE=true
```

### –§—Ä–æ–Ω—Ç–µ–Ω–¥ (.env)

```env
REACT_APP_API_URL=http://localhost:5000
```

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±—ç–∫–µ–Ω–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- **Swagger UI**: http://localhost:5000/docs
- **ReDoc**: http://localhost:5000/redoc

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**
- `POST /api/auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/auth/login` - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- `GET /api/auth/verify` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞

**–ß–∞—Ç—ã:**
- `GET /api/chats` - –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/chats` - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞
- `GET /api/chats/{id}` - –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Ç–∞ —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- `PUT /api/chats/{id}` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞
- `DELETE /api/chats/{id}` - –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–∞

**–°–æ–æ–±—â–µ–Ω–∏—è:**
- `PUT /api/chats/{chat_id}/messages/{message_id}` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `DELETE /api/chats/{chat_id}/messages/{message_id}` - –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**–ß–∞—Ç —Å –ø–æ–∏—Å–∫–æ–º:**
- `POST /api/chat/search` - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–æ–∏—Å–∫–æ–º –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:**
- `POST /api/image/upload` - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è img-to-img
- `POST /api/image/generate` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (text-to-image –∏–ª–∏ img-to-img)
- `POST /api/image/generate/stream` - –ü–æ—Ç–æ–∫–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `GET /api/image/{message_id}` - –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏:**
- `POST /api/process/switch?service={ollama|comfyui}` - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É Ollama –∏ ComfyUI
- `GET /api/process/status` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (Ollama/ComfyUI)

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**POST /api/image/generate**

```json
{
  "chat_id": 1,
  "description": "–°–¥–µ–ª–∞—Ç—å –∑–∞–±–æ—Ä –±–µ–ª—ã–º",
  "width": 1024,
  "height": 1024,
  "reference_image_id": 123,
  "batch_count": 1
}
```

- `chat_id` (required) - ID —á–∞—Ç–∞
- `description` (required) - –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- `width` (optional) - –®–∏—Ä–∏–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–¥–ª—è text-to-image)
- `height` (optional) - –í—ã—Å–æ—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–¥–ª—è text-to-image)
- `reference_image_id` (optional) - ID —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º (–¥–ª—è img-to-img)
- `batch_count` (optional, 1-4) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

## üß™ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### Backend
- **FastAPI** - –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Python
- **SQLAlchemy** - ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **MySQL** - –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **JWT** - JSON Web Tokens –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **Bcrypt** - –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- **Pydantic** - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Tavily API** - –ü–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ
- **ComfyUI API** - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ Flux.1-dev
- **Ollama** - –õ–æ–∫–∞–ª—å–Ω—ã–µ LLM –º–æ–¥–µ–ª–∏ (GPT-OSS, LLaVA)
- **Pillow** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **pynvml** - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPU

### Frontend
- **React** - JavaScript –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è UI
- **React Markdown** - –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ Markdown
- **React Icons** - –ò–∫–æ–Ω–∫–∏

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—Å—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "Create image" –≤ –º–µ–Ω—é –ø–ª—é—Å–∞
3. –í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. –ù–∞–∂–º–∏—Ç–µ "Generate"
6. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–æ–±—ã—á–Ω–æ 30-120 —Å–µ–∫—É–Ω–¥)
7. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—è–≤–∏—Ç—Å—è –≤ —á–∞—Ç–µ

### –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "Create image" –≤ –º–µ–Ω—é –ø–ª—é—Å–∞
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (drag & drop –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "+")
4. –í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∂–µ–ª–∞–µ–º—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
5. –ù–∞–∂–º–∏—Ç–µ "Generate"
6. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
   - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ LLaVA
   - –°–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Natural Language –ø—Ä–æ–º–ø—Ç
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
7. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—è–≤–∏—Ç—Å—è –≤ —á–∞—Ç–µ

### Batch –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

1. –ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É–∫–∞–∂–∏—Ç–µ `batch_count` (1-4)
2. –°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞—Å—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ seed
3. –í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —á–∞—Ç–µ
4. –í—ã–±–µ—Ä–∏—Ç–µ –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é bcrypt
- JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ó–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π —á–µ—Ä–µ–∑ SQLAlchemy ORM
- CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (Pydantic)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–æ 1024px –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Ollama –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Flux.1-dev
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö)
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ Ollama –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º ComfyUI
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ Ollama –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

–°–º. [TROUBLESHOOTING.md](TROUBLESHOOTING.md) –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º.

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## ü§ù –í–∫–ª–∞–¥

–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è –ª—é–±—ã–µ —É–ª—É—á—à–µ–Ω–∏—è! –°–æ–∑–¥–∞–≤–∞–π—Ç–µ issues –∏ pull requests.

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã, —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
